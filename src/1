<?php
// src/AppBundle/Controller/AppController.php
namespace AppBundle\Controller;

use Sensio\Bundle\FrameworkExtraBundle\Configuration\Route;
use Symfony\Component\HttpFoundation\Response;
use Symfony\Component\HttpFoundation\JsonResponse;
use AppBundle\Entity\Sections;
use AppBundle\Entity\Games;
use AppBundle\Entity\Apps;
use Doctrine\ORM\EntityManagerInterface;
use Symfony\Bundle\FrameworkBundle\Controller\Controller;

class AppController extends Controller
{
	private function response($status, $report)
	{
		return new JsonResponse(['Status' => $status, 'Report' => $report]);
	}

	private function applyToDBase($object)
	{
		try{
			$em = $this->getDoctrine()->getManager();
			$em->persist($object);
			$em->flush();
		}
		catch (\Doctrine\DBAL\DBALException $e)
		{
			return $this->response('failed', $e->getMessage());
		}
		
	}
	/**
	 * @Route("/app")
	 */
	public function numberAction()
	{
		try{
			$em = $this->getDoctrine()->getManager();
			$games = new Games();
			$games->setGame('atendee_network');
			$games->setLabel('Atendee Network');
			$games->setSections(['my_network', 'games']);
			$em->persist($games);
			$em->flush();
		}
		catch (\Doctrine\DBAL\DBALException $e)
		{
			return new Response($e->getMessage());
		}
		return new Response('Saved new product with id ');
	}
	/**
	 * @Route("/create/{appName}")
	 */
	public function createApp($appName)
	{
		$games = $this->getDoctrine()
			->getRepository('AppBundle:Games')
			->findAll();

		if (!$games)
		{
			throw $this->respond('failed', 'No game found');
		}
		
		foreach ($games as $game)
		{
			echo $game->getGame();
		}		
		return $this->response('hello', $games);
	}
}
?>
